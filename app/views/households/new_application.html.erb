 <article class="profile">

 	<%= render 'shared/back_header', :c => "Applications", :l => applications_household_path(@household) %>

 	<div class="wrapper">

 		<div class="grid">

 			<div class="xl-12 l-12 ltl-12">

 				<%= form_for @application, :url => create_application_household_path(@household), :html => {:class => "box form form-normal"} do |f| %>

 				<div class="box-header">
 					New Application
 				</div>

 				<div class="box-content narrow">

 					<% if @application.errors.any? %>
 					<div class="alert alert-danger">
 						<% @application.errors.full_messages.each do |msg| %>
 						<%= msg %><br>
 						<% end %>
 					</div>
 					<% end %>

 					<h2>General Information</h2>
 					<div class="grid">
 						<div class="xl-6 l-6 ltl-12">
 							<label class="form-field">
 								<span class="label">Select School</span>
 								<div class="select">
 									<%= f.select :school_id, options_for_select(School.all.map{|s| [s.name, s.id]}, @application.school_id), {:include_blank => true}, :class => "input" %>
 								</div>
 								<p class="help-block">Don't see your school listed? <a href="#">Contact us</a></p>
 							</label>
 						</div>
 						<div class="xl-3 l-3 ltl-12">
 							<label class="form-field">
 								<span class="label">Academic Year</span>
 								<div class="select">
 									<%= f.select :school_year, options_for_select(Application::SCHOOL_YEARS.map{ |e| [e,e] }), {}, :class => "input" %>
 								</div>
 							</label>
 						</div>
 					</div>

 					<hr>	
 					<h2>Applicant</h2>
 					<%= f.fields_for :applicants do |ff| %>
 						<%= render 'applicant', :f => ff %>
 					<% end %>
 					<hr>
 					<h2>Parent or Guardian</h2>

 					<div class="grid">
 						<div class="xl-6 l-6 ltl-12">
 							<label class="form-field">
 								<span class="label">First Name</span>
 								<%= f.text_field :parent_first_name, :class => "input" %>
 							</label>
 						</div>
 						<div class="xl-6 l-6 ltl-12">
 							<label class="form-field">
 								<span class="label">Last Name</span>
 								<%= f.text_field :parent_last_name, :class => "input" %>
 							</label>
 						</div>
 					</div>

 					<div class="grid">
 						<div class="xl-4 l-4 ltl-12">
 							<label class="form-field">
 								<span class="label">Middle Initial</span>
 								<%= f.text_field :parent_middle_initial, :class => "input" %>
 							</label>
 						</div>
 						<div class="xl-8 l-8 ltl-12">
 						</div>
 					</div>

 					<div class="grid">
 						<div class="xl-5 l-5 ltl-12">
 							<label class="form-field">
 								<span class="label">Email Address</span>
 								<%= f.text_field :email, :class => "input" %>
 							</label>
 						</div>
 						<div class="xl-5 l-5 ltl-12">
 							<label class="form-field">
 								<span class="label">Confirm Email Address</span>
 								<%= f.text_field :confirm_email, :class => "input" %>
 							</label>
 						</div>
 					</div>

 					<div class="grid">
 						<div class="xl-5 l-5 ltl-12">
 							<label class="form-field">
 								<span class="label">Phone Number</span>
 								<%= f.text_field :phone, :class => "input" %>
 							</label>
 						</div>
 						<div class="xl-6 l-6 ltl-12"></div>
 					</div>

 					<label class="form-field"> 
 						<%= check_box_tag "same_address" %>
 						<span class="text">Address same as applicant(s)?</span>
 					</label>

 					<div class="grid">
 						<div class="xl-6 l-6 ltl-12">
 							<label class="form-field">
 								<span class="label">Address</span>
 								<%= f.text_field :address, :class => "input" %>
 							</label>
 						</div>
 						<div class="xl-2 l-2 ltl-12">
 							<label class="form-field">
 								<span class="label">Apt #</span>
 								<%= f.text_field :apartment_number, :class => "input" %>
 							</label>
 						</div>
 					</div>

 					<div class="grid">
 						<div class="xl-5 l-5 ltl-12">
 							<label class="form-field">
 								<span class="label">City</span>
 								<%= f.text_field :city, :class => "input" %>
 							</label>
 						</div>
 						<div class="xl-2 l-2 ltl-12">
 							<label class="form-field">
 								<span class="label">State</span>
 								<%= f.text_field :state, :class => "input", :readonly => true %>
 							</label>
 						</div>
 						<div class="xl-2 l-2 ltl-12">
 							<label class="form-field">
 								<span class="label">Zip</span>
 								<%= f.text_field :zip, :class => "input" %>
 							</label>
 						</div>
 					</div>

 					<hr>

 					<label class="form-field">
 						<span class="label">Income Verification</span>
 						<p class="help-block">
 							In order to approve your application, we require you share with us the number of individuals living in your household as well as your adjusted gross income. Your school will collect the necessary documentation to verify this information. If you have already provided the school with the necessary documentation, you will likely not need to provide any additional information.
 						</p>
 						<br>
 						<p class="help-block">
							If you have further questions about this process, please contact the school directly.
 						</p>
 					</label>

 					<div class="grid">
 						<div class="xl-3 l-3 ltl-12">
 							<label class="form-field">
 								<span class="label">Number in Household</span>
 								<div class="select">
 									<%= f.select :number_in_household, [1,2,3,4,5,6,7,8,9,10], {:include_blank => true}, :class => "input" %>
 								</div>
 							</label>
 						</div>
 					</div>

 					<div class="grid">
 						<div class="xl-5 l-5 ltl-12">
 							<label class="form-field">
 								<span class="label">Annual Household Income</span>
 								<%= f.text_field :household_income, :class => "input currency" %>
 							</label>
 						</div>
 					</div>

 					<hr>
 					<%= f.submit "Submit Application", :class => "btn btn-secondary btn-block" %>

 				</div>

 				<% end %>

 			</div>

 		</div>

 	</div>

 </article>

 <script type="text/javascript">

	 // Update annual tuition
	 // $("#application_school_id").on('change', function(){
	 // 	data = $(this).val();

	 // 	if (data.length > 0){
	 // 		$.ajax({
	 // 			dataType: "json",
	 // 			url: "/api/schools/" + data + "/tuition",
	 // 			success: function(data){
	 // 				$("#annual-tuition").val(data.tuition)
	 // 			}
	 // 		});
	 // 	} else {
	 // 		$("#annual-tuition").val("$")
	 // 	}
	 // });

 	// Add applicants
 	$('form .add-fields').click(function(e){
 		var time = new Date().getTime();
 		var regexp = new RegExp($(this).data('id'), 'g');
 		$(this).before($(this).data('fields').replace(regexp, time));
 		e.preventDefault();
 	});

 	// address same as applicants
 	$('#same_address').click(function(){
 		if(this.checked){
 			$("#application_address").val($("#application_applicants_attributes_0_address").val());
 			$("#application_apartment_number").val($("#application_applicants_attributes_0_apartment_number").val());
 			$("#application_city").val($("#application_applicants_attributes_0_city").val());
 			$("#application_zip").val($("#application_applicants_attributes_0_zip").val());
 		} else { 
 			$("#application_address").val("");
 			$("#application_apartment_number").val("");
 			$("#application_city").val("");
 			$("#application_zip").val("");
 		};
 	});
 	</script>